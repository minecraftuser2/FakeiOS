<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fake iOS Home Screen</title>
<style>
  /* Basic reset and body styling */
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    background: #f0f0f5;
    color: #000;
    user-select: none;
    -webkit-user-select: none;
  }
  /* Home screen container */
  #home-screen {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 18px;
    padding: 30px 16px 100px;
  }
  /* App icon styling */
  .app-icon {
    width: 80px;
    height: 80px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 4px 8px rgb(0 0 0 / 0.15);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.15s ease;
  }
  .app-icon:active {
    transform: scale(0.9);
  }
  .app-icon img {
    width: 44px;
    height: 44px;
  }
  .app-icon span {
    margin-top: 8px;
    font-size: 13px;
    font-weight: 600;
    color: #222;
  }
  /* App screen modal */
  #app-screen {
    position: fixed;
    top: 10vh;
    left: 50%;
    transform: translateX(-50%);
    width: 360px;
    max-width: 95vw;
    height: 600px;
    background: white;
    border-radius: 30px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
    display: none;
    flex-direction: column;
    overflow: hidden;
    z-index: 10;
  }
  #app-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    border-bottom: 1px solid #ccc;
    font-weight: 600;
    font-size: 18px;
    background: #f7f7f7;
  }
  #app-title {
    user-select: none;
  }
  #app-close {
    background: #e0e0e0;
    border: none;
    border-radius: 12px;
    width: 32px;
    height: 32px;
    font-weight: 700;
    font-size: 20px;
    line-height: 28px;
    cursor: pointer;
    color: #444;
    transition: background 0.3s ease;
  }
  #app-close:hover {
    background: #d0d0d0;
  }
  #app-content {
    flex: 1;
    padding: 12px 16px;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  /* Switch styling for Settings */
  .switch {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 12px 0;
    font-size: 16px;
  }
  .switch input {
    width: 40px;
    height: 20px;
    position: relative;
    appearance: none;
    background: #ccc;
    outline: none;
    border-radius: 10px;
    transition: background 0.3s;
    cursor: pointer;
  }
  .switch input:checked {
    background: #007aff;
  }
  .switch input::before {
    content: "";
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    top: 2px;
    left: 2px;
    background: white;
    transition: 0.3s;
  }
  .switch input:checked::before {
    left: 22px;
  }
  /* Canvas for Block Blast */
  #blockblast-canvas {
    touch-action: none;
  }
  /* Drawing Canvas for Procreate Portable */
  #drawCanvas {
    border-radius: 12px;
    background: #fff;
    box-shadow: 0 0 10px #aaa;
    display: block;
    margin: 12px auto;
    border: 1px solid #ccc;
  }
  /* Vertical mode for Settings */
  body.vertical-mode #home-screen {
    flex-direction: column;
    align-items: center;
    padding-bottom: 30px;
  }
</style>
</head>
<body>

<div id="home-screen">
  <div class="app-icon" data-app="Messages">
    <img src="https://img.icons8.com/ios/50/000000/sms.png" alt="Messages" />
    <span>Messages</span>
  </div>
  <div class="app-icon" data-app="Block Blast">
    <img src="https://img.icons8.com/ios/50/000000/block.png" alt="Block Blast" />
    <span>Block Blast</span>
  </div>
  <div class="app-icon" data-app="Browser">
    <img src="https://img.icons8.com/ios/50/000000/internet--v1.png" alt="Browser" />
    <span>Browser</span>
  </div>
  <div class="app-icon" data-app="Settings">
    <img src="https://img.icons8.com/ios/50/000000/settings.png" alt="Settings" />
    <span>Settings</span>
  </div>
  <div class="app-icon" data-app="Procreate Portable">
    <img src="https://img.icons8.com/ios/50/000000/paint-palette.png" alt="Procreate Portable" />
    <span>Procreate</span>
  </div>
</div>

<div id="app-screen" role="dialog" aria-modal="true" aria-labelledby="app-title">
  <div id="app-header">
    <div id="app-title">App</div>
    <button id="app-close" aria-label="Close app">&times;</button>
  </div>
  <div id="app-content"></div>
</div>

<script>
  // App open and close handlers
  const homeScreen = document.getElementById('home-screen');
  const appScreen = document.getElementById('app-screen');
  const appTitle = document.getElementById('app-title');
  const appContent = document.getElementById('app-content');
  const appClose = document.getElementById('app-close');

  homeScreen.addEventListener('click', e => {
    const appIcon = e.target.closest('.app-icon');
    if (!appIcon) return;
    const appName = appIcon.getAttribute('data-app');
    openApp(appName);
  });

  appClose.addEventListener('click', () => {
    appScreen.style.display = 'none';
    appContent.innerHTML = '';
  });

  function openApp(name) {
    appTitle.textContent = name;
    appContent.innerHTML = "";
    appScreen.style.display = 'flex';

    if (name === "Messages") {
      appContent.innerHTML = "ðŸ’¬ This is the Messages app.";
    } else if (name === "Block Blast") {
      const rows = 8;
      const cols = 8;
      const blockSize = 40;
      const colors = ['red', 'green', 'blue', 'yellow', 'purple'];

      appContent.innerHTML = `
        <div style="text-align:center; margin-top:12px; font-weight:bold; font-size:18px;">Block Blast</div>
        <canvas id="blockblast-canvas" width="${cols * blockSize}" height="${rows * blockSize}" 
                style="background:#222; display:block; margin:12px auto; border-radius:12px; touch-action:none;"></canvas>
        <div style="text-align:center; margin-top: 8px; font-weight:bold; font-size:16px;">Score: <span id="bb-score">0</span></div>
        <button id="bb-restart" style="
          margin-top: 12px; padding: 10px 24px; font-weight:bold; font-size:16px; border:none; border-radius:12px;
          background:#007aff; color:#fff; cursor:pointer;
        ">Restart</button>
      `;

      const canvas = document.getElementById('blockblast-canvas');
      const ctx = canvas.getContext('2d');
      let grid = [];
      let score = 0;

      function randomColor() {
        return colors[Math.floor(Math.random() * colors.length)];
      }

      function initGrid() {
        grid = [];
        for (let r = 0; r < rows; r++) {
          let row = [];
          for (let c = 0; c < cols; c++) {
            row.push(randomColor());
          }
          grid.push(row);
        }
      }

      function drawGrid() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let r = 0; r < rows; r++) {
          for (let c = 0; c < cols; c++) {
            const x = c * blockSize;
            const y = r * blockSize;
            ctx.fillStyle = grid[r][c];
            ctx.fillRect(x + 2, y + 2, blockSize - 4, blockSize - 4);
            ctx.strokeStyle = '#111';
            ctx.strokeRect(x + 2, y + 2, blockSize - 4, blockSize - 4);
          }
        }
      }

      function findMatches() {
        let matches = [];
        // horizontal matches
        for (let r = 0; r < rows; r++) {
          let matchLength = 1;
          for (let c = 1; c < cols; c++) {
            if (grid[r][c] === grid[r][c - 1]) {
              matchLength++;
            } else {
              if (matchLength >= 3) {
                for (let i = 0; i < matchLength; i++) {
                  matches.push({r: r, c: c - 1 - i});
                }
              }
              matchLength = 1;
            }
          }
          if (matchLength >= 3) {
            for (let i = 0; i < matchLength; i++) {
              matches.push({r: r, c: cols - 1 - i});
            }
          }
        }
        // vertical matches
        for (let c = 0; c < cols; c++) {
          let matchLength = 1;
          for (let r = 1; r < rows; r++) {
            if (grid[r][c] === grid[r - 1][c]) {
              matchLength++;
            } else {
              if (matchLength >= 3) {
                for (let i = 0; i < matchLength; i++) {
                  matches.push({r: r - 1 - i, c: c});
                }
              }
              matchLength = 1;
            }
          }
          if (matchLength >= 3) {
            for (let i = 0; i < matchLength; i++) {
              matches.push({r: rows - 1 - i, c: c});
            }
          }
        }
        // Remove duplicates
        let uniqueMatches = [];
        let seen = {};
        matches.forEach(pos => {
          let key = pos.r + ',' + pos.c;
          if (!seen[key]) {
            uniqueMatches.push(pos);
            seen[key] = true;
          }
        });
        return uniqueMatches;
      }

      function removeMatchesAndCollapse(matches) {
        if (matches.length === 0) return false;

        score += matches.length * 10;
        document.getElementById('bb-score').textContent = score;

        matches.forEach(({r, c}) => {
          grid[r][c] = null;
        });

        // Collapse columns down
        for (let c = 0; c < cols; c++) {
          let col = [];
          for (let r = 0; r < rows; r++) {
            if (grid[r][c] !== null) {
              col.push(grid[r][c]);
            }
          }
          while (col.length < rows) {
            col.unshift(randomColor());
          }
          for (let r = 0; r < rows; r++) {
            grid[r][c] = col[r];
          }
        }
        return true;
      }

      function swapBlocks(r1, c1, r2, c2) {
        const temp = grid[r1][c1];
        grid[r1][c1] = grid[r2][c2];
        grid[r2][c2] = temp;
      }

      function isAdjacent(r1, c1, r2, c2) {
        return (r1 === r2 && Math.abs(c1 - c2) === 1) || (c1 === c2 && Math.abs(r1 - r2) === 1);
      }

      let selected = null;

      canvas.addEventListener('pointerdown', e => {
        e.preventDefault();
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        const c = Math.floor(x / blockSize);
        const r = Math.floor(y / blockSize);
        if (r < 0 || r >= rows || c < 0 || c >= cols) return;

        if (!selected) {
          selected = {r, c};
          drawGrid();
          highlightBlock(selected.r, selected.c);
        } else {
          if (r === selected.r && c === selected.c) {
            selected = null;
            drawGrid();
          } else if (isAdjacent(r, c, selected.r, selected.c)) {
            swapBlocks(r, c, selected.r, selected.c);
            const matches = findMatches();
            if (matches.length > 0) {
              function clearLoop() {
                const m = findMatches();
                if (m.length > 0) {
                  removeMatchesAndCollapse(m);
                  drawGrid();
                  setTimeout(clearLoop, 300);
                }
              }
              clearLoop();
            } else {
              swapBlocks(r, c, selected.r, selected.c);
            }
            selected = null;
            drawGrid();
          } else {
            selected = {r, c};
            drawGrid();
            highlightBlock(selected.r, selected.c);
          }
        }
      });

      function highlightBlock(r, c) {
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 3;
        ctx.strokeRect(c * blockSize + 3, r * blockSize + 3, blockSize - 6, blockSize - 6);
      }

      appContent.querySelector('#bb-restart').addEventListener('click', () => {
        score = 0;
        document.getElementById('bb-score').textContent = score;
        initGrid();
        drawGrid();
      });

      initGrid();
      drawGrid();

    } else if (name === "Browser") {
      appContent.innerHTML = `
        <div style="display:flex; padding:8px 12px; gap:8px; border-bottom:1px solid #ccc; background:#f2f2f7;">
          <input id="addressInput" type="text" placeholder="Enter URL or search" 
                 style="flex:1; border-radius:12px; border:1px solid #ccc; padding:6px 12px; font-size:14px;" />
          <button id="goButton" style="
            background:#007aff; color:#fff; border:none; border-radius:12px; padding:6px 14px; font-weight:600;
            cursor:pointer;
          ">Go</button>
        </div>
        <iframe id="browserFrame" src="https://example.com" style="width:100%; flex:1; border:none; border-radius: 0 0 16px 16px; height:500px;"></iframe>
      `;

      const input = appContent.querySelector('#addressInput');
      const button = appContent.querySelector('#goButton');
      const iframe = appContent.querySelector('#browserFrame');

      function loadURL() {
        let url = input.value.trim();
        if (!url) return;
        if (!url.startsWith('http://') && !url.startsWith('https://')) {
          url = 'https://' + url;
        }
        iframe.src = url;
      }

      button.addEventListener('click', loadURL);
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') loadURL();
      });

    } else if (name === "Settings") {
      appContent.innerHTML = `
        <label class="switch">Airplane Mode <input type="checkbox" /></label>
        <label class="switch">Wi-Fi <input type="checkbox" checked /></label>
        <label class="switch">Bluetooth <input type="checkbox" /></label>
        <label class="switch">Dark Mode <input type="checkbox" /></label>
        <button id="toggleOrientationBtn" style="
          margin: 20px 16px;
          padding: 10px;
          width: calc(100% - 32px);
          background: #007aff;
          color: white;
          border: none;
          border-radius: 12px;
          font-weight: 600;
          cursor: pointer;
          font-size: 16px;
        ">Switch to Vertical Mode</button>
      `;

      setTimeout(() => {
        const toggleBtn = document.getElementById('toggleOrientationBtn');
        toggleBtn.addEventListener('click', () => {
          document.body.classList.toggle('vertical-mode');
          if(document.body.classList.contains('vertical-mode')){
            toggleBtn.textContent = "Switch to Horizontal Mode";
          } else {
            toggleBtn.textContent = "Switch to Vertical Mode";
          }
        });

        // Initialize button text
        toggleBtn.textContent = document.body.classList.contains('vertical-mode') ? "Switch to Horizontal Mode" : "Switch to Vertical Mode";
      }, 50);

    } else if (name === "Procreate Portable") {
      appContent.innerHTML = `
        <canvas id="drawCanvas" width="320" height="360"></canvas>
        <div style="text-align:center; margin-top: 8px;">
          <input type="color" id="colorPicker" value="#000000" />
          <button id="clearCanvasBtn" style="margin-left:10px;padding:6px 12px;font-size:14px;">Clear</button>
        </div>
      `;

      setTimeout(() => {
        const canvas = document.getElementById('drawCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;
        let lastX = 0;
        let lastY = 0;
        const colorPicker = document.getElementById('colorPicker');
        const clearBtn = document.getElementById('clearCanvasBtn');

        function startDraw(e) {
          drawing = true;
          [lastX, lastY] = [e.offsetX, e.offsetY];
        }
        function draw(e) {
          if (!drawing) return;
          ctx.strokeStyle = colorPicker.value;
          ctx.lineWidth = 3;
          ctx.lineJoin = 'round';
          ctx.lineCap = 'round';
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(e.offsetX, e.offsetY);
          ctx.stroke();
          [lastX, lastY] = [e.offsetX, e.offsetY];
        }
        function stopDraw() {
          drawing = false;
        }

        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDraw);
        canvas.addEventListener('mouseout', stopDraw);

        clearBtn.addEventListener('click', () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        });
      }, 100);

    } else {
      appContent.innerHTML = `<p>App "${name}" not implemented yet.</p>`;
    }
  }
</script>

</body>
</html>
